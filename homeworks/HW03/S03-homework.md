# Домашнее задание к семинару 03 (HW03)

Тема: мини-приложение на Python для EDA – структура проекта, CLI и расширение функциональности.

HW03 относится к семинару **S03** и выполняется в личном репозитории студента, созданном на основе шаблона `aie-student-template`, в папке `homeworks/HW03/`.

---

## 1. Цель

Закрепить:

- базовые навыки работы с **проектом на `uv`** и структурой `pyproject.toml + src/`-layout;
- понимание того, как EDA-логика на Pandas/Matplotlib оформляется в виде отдельных модулей и функций;
- умение **расширять готовый Python-проект**:
  - добавлять новые эвристики качества данных;
  - параметризовать CLI-команды;
  - покрывать изменения простыми тестами.

---

## 2. Задание

### 2.1. Структура для HW03

1. В корне репозитория должна быть папка `homeworks/` (создать, если её ещё нет).
2. Внутри `homeworks/` создать папку `HW03/`.
3. В папке `homeworks/HW03/` должна лежать копия проекта семнар **S03** с мини-приложением `eda-cli`. Рекомендуемая структура:

   ```text
   homeworks/
     HW03/
       eda-cli/
         pyproject.toml
         README.md
         src/
           eda_cli/
             __init__.py
             core.py
             viz.py
             cli.py
         tests/
           test_core.py
         data/
           example.csv
    ```

    Допустимо другое имя вложенной папки (например, `mini-eda-cli/`), но:

   - должно быть очевидно, что в `HW03/` лежит **целый проект** (а не отдельные файлы);
   - в нём должны быть и `pyproject.toml`, и `src/`, и `tests/`.

4. Не нужно копировать во внутренний проект:

   - виртуальное окружение `.venv/`;
   - временные каталоги (`.pytest_cache/`, `reports/` и аналогичные);
   - большие исходные датасеты, не относящиеся к заданию.

> Если часть структуры уже создана на семинаре, убедитесь, что именование папок и файлов аккуратное и понятное.

---

### 2.2. Подготовка проекта

Перед внесением изменений убедитесь, что проект успешно запускается в вашем окружении.

1. Перейдите в папку с проектом внутри `HW03/`, например:

   ```bash
   cd homeworks/HW03/eda-cli
   ```

2. Выполните установку зависимостей через `uv`:

   ```bash
   uv sync
   ```

3. Проверьте, что CLI работает на учебном датасете:

   ```bash
   uv run eda-cli overview data/example.csv
   uv run eda-cli report data/example.csv --out-dir reports_example
   ```

4. При необходимости поправьте пути к `data/example.csv` в README или собственных заметках.

Если на этом этапе возникают ошибки, рекомендуется сначала добиться корректного запуска исходной версии проекта, а уже потом переходить к заданию.

---

### 2.3. Основное задание: расширение функциональности `eda-cli`

Основная часть HW03 — **инженерная**: вы дорабатываете уже существующий проект.

#### 2.3.1. Новые эвристики качества данных - сделано

В модуле `src/eda_cli/core.py` в функции `compute_quality_flags`:

1. Добавьте **не менее двух новых эвристик качества данных**. Примеры (можно выбрать свои, но они должны быть осмысленными):

   - `has_constant_columns` — флаг, показывающий, есть ли колонки, где все значения одинаковые. - сделано
   - `has_high_cardinality_categoricals` — флаг, сигнализирующий, что есть категориальные признаки с очень большим числом уникальных значений (нужно определить свой порог). - сделано
   - `has_suspicious_id_duplicates` — проверка, что идентификатор (например, `user_id`) уникален; при наличии дубликатов выставлять флаг.
   - `has_many_zero_values` — для числовых колонок проверить долю нулей и выставить флаг, если она превышает выбранный порог.

2. Включите новые флаги в возвращаемый словарь из `compute_quality_flags` так, чтобы ими можно было пользоваться из других частей кода.

3. Убедитесь, что ваши эвристики **корректно работают** хотя бы на `data/example.csv` и на одном дополнительном небольшом датасете (можно использовать учебные данные из HW02 или придумать небольшой CSV самостоятельно).

4. При необходимости скорректируйте расчёт интегрального показателя `quality_score`, чтобы он учитывал новые факторы (это не обязательно, но приветствуется).

---

#### 2.3.2. Новые параметры CLI-команды `report` - сделано

В модуле `src/eda_cli/cli.py` доработайте команду `report` так, чтобы она принимала **дополнительные параметры**, влияющие на отчёт. Нужно реализовать:

1. Не менее **двух новых опций командной строки**, например:

   - `--max-hist-columns` – сколько числовых колонок включать в набор гистограмм (по умолчанию можно оставить текущее значение, но дать возможность его изменить). - сделано
   - `--top-k-categories` – сколько top-значений выводить для категориальных признаков. - сделано
   - `--title` – заголовок отчёта (`# ...` в начале `report.md`). - сделано
   - `--min-missing-share` – порог доли пропусков, выше которого колонка считается проблемной и попадает в отдельный список в отчёте.

2. Реально использовать эти параметры внутри функции `report`:

   - передавать значения в функции из `core.py` и `viz.py` (там, где это уместно);
   - включать информацию о новых порогах/настройках в генерируемый `report.md` (например, отдельной строкой в разделе «Качество данных» или в разделах про пропуски/категориальные признаки).

3. Обновить `README.md` проекта или краткий текстовый блок (при его отсутствии можно создать минимальный `README.md`), где описать:

   - какие команды CLI доступны (минимум `overview` и `report`);
   - какие новые параметры добавлены к `report` и как они влияют на отчёт;
   - пример вызова `eda-cli report` с новыми опциями.

---

#### 2.3.3. Минимальные тесты под свои изменения

В файле `tests/test_core.py` добавьте **не менее одного теста**, который проверяет вашу новую логику.

1. Создайте небольшой DataFrame внутри теста, который позволяет проверить хотя бы одну из ваших новых эвристик в `compute_quality_flags`. Например:

   - DataFrame с константной колонкой для проверки `has_constant_columns`;
   - DataFrame с категорией, где очень много уникальных значений, для `has_high_cardinality_categoricals`;
   - DataFrame с дублирующимися идентификаторами для `has_suspicious_id_duplicates`.

2. Напишите тест, который:

   - вызывает `compute_quality_flags` на этом DataFrame;
   - проверяет, что соответствующий флаг принимает ожидаемое значение (`True`/`False`);
   - при необходимости проверяет корректность связанных величин (например, долю нулей или пропусков).

3. Убедитесь, что полный набор тестов проходит без ошибок:

   ```bash
   uv run pytest -q
   ```

---

## 3. Требования к структуре и именованию

Обязательная структура к дедлайну:

- в корне репозитория: папка `homeworks/`;
- внутри неё: папка `HW03/`;
- внутри `HW03/`: подпапка с проектом `eda-cli` (или аналогичным названием), содержащая:

  - `pyproject.toml`;
  - каталог `src/` с пакетом `eda_cli`;
  - каталог `tests/` с тестами;
  - папку `data/` с учебным файлом `example.csv`.

Требования:

- названия папок `homeworks/` и `HW03/` должны быть **строго такими**, как указано (регистр букв важен);
- в проекте не должно быть закоммичено виртуальное окружение `.venv/` и другие временные каталоги;
- проект должен запускаться командами:

  ```bash
  cd homeworks/HW03/eda-cli   # или соответствующий путь
  uv sync
  uv run eda-cli report data/example.csv --out-dir reports_example
  uv run pytest -q
  ```

  (путь к папке проекта и имени каталога может отличаться, но команды должны работать внутри вашего проекта).

---

## 4. Критерии зачёта

Домашнее задание считается зачтённым, если:

1. В публичном репозитории студента присутствует папка `homeworks/HW03/` с вложенным проектом `eda-cli` (или эквивалентной структурой проекта на `uv` с модулем `eda_cli`).
2. В модуле `core.py` реализовано не менее двух дополнительных эвристик качества данных, и они:

   - возвращаются из `compute_quality_flags`;
   - используются при формировании отчёта (на уровне текста или расчёта итогового `quality_score`).
3. В модуле `cli.py` команда `report` принимает дополнительные параметры, влияющие на содержимое отчёта, и эти параметры:

   - описаны в help-тексте команды;
   - реально используются в логике генерации отчёта.
4. В `tests/test_core.py` добавлен хотя бы один новый тест, проверяющий корректность реализации хотя бы одной новой эвристики качества данных.
5. Все тесты проходят успешно (`uv run pytest -q`), а команда отчёта работает минимум на учебном датасете:

   ```bash
   uv run eda-cli report data/example.csv --out-dir reports_example
   ```

Дополнительно приветствуется (но не обязательно для зачёта):

- аккуратное оформление `README.md` с описанием команд и примеров запуска;
- реализация одного или нескольких вариантов из дополнительной части (новые команды CLI, JSON-сводка, дополнительные визуализации);
- проверка работы проекта на собственном CSV-файле помимо `example.csv`.

---

## 5. Сроки и порядок сдачи

- Работа выполняется **индивидуально**.
- Дедлайн выполнения HW03 объявляется преподавателем отдельно (в чате/на портале курса).
- Фактом сдачи работы считается наличие к указанному дедлайну:

  - публичного репозитория студента;
  - структуры `homeworks/HW03/` с вложенным проектом `eda-cli` (или эквивалентным);
  - внесённых изменений в код (эвристики, параметры CLI, тесты), находящихся в актуальной версии основной ветки (`main` или другой заранее оговорённой).
- Проверка осуществляется через клонирование репозитория преподавателем и запуск указанных в этом документе команд `uv run …` внутри проекта.

---
